<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MackiesPhoneApp.Pages.User.HomeView">

    <ScrollView>
        <VerticalStackLayout 
            Padding="16"
            Spacing="16"
            BackgroundColor="{AppThemeBinding Light={StaticResource AppToolbarBackgroundColorLight}, 
                                                  Dark={StaticResource AppToolbarBackgroundColorDark}}">

            <!-- Logged-in user -->
            <Label x:Name="LoggedInUserDisplayName"
                   FontSize="24"
                   FontAttributes="Bold"
                   TextColor="White" />

            <!-- Header -->
            <VerticalStackLayout Spacing="8">
                <Label Text="JJ Fisk - en seriÃ¸s fiskehandler"
                       FontSize="24"
                       FontAttributes="Bold"
                       HorizontalTextAlignment="Center"
                       TextColor="White" />

                <Label Text="Vi holder med fiskebilerne her:"
                       FontSize="16"
                       TextColor="White"
                       HorizontalTextAlignment="Center"
                       LineHeight="1.5" />
            </VerticalStackLayout>

            <!-- Fish shops list -->
            <CollectionView x:Name="FishShopCollectionView"
                            SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Stroke="{AppThemeBinding Light={StaticResource ViewItemBorderColorLight}, 
                                                          Dark={StaticResource ViewItemBorderColorDark}}"
                                StrokeShape="RoundRectangle 8"
                                BackgroundColor="{AppThemeBinding Light=LightGray, Dark={StaticResource ViewItemBackgroundColorDark}}"
                                Padding="12"
                                Margin="4">

                            <VerticalStackLayout Spacing="12">
                                <!-- Shop header -->
                                <Grid ColumnSpacing="12"
                                      RowSpacing="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <!-- Shop name -->
                                    <Label Text="{Binding Name}"
                                           FontSize="18"
                                           TextColor="White"
                                           Grid.Row="0" Grid.Column="0" />

                                    <!-- Toggle contact button -->
                                    <Button  Text="Vis kontakt"
                                            FontSize="12"
                                            Padding="6,2"
                                            CornerRadius="12"
                                            BackgroundColor="White"
                                            TextColor="Black"
                                            Grid.Row="0" Grid.Column="1"
                                            Clicked="OnToggleShowContactTapped" />

                                    <!-- Contact info -->
                                    <VerticalStackLayout IsVisible="{Binding IsVisibleContactInfo}"
                                                         Spacing="2"
                                                         Grid.Row="1" Grid.Column="1"
                                                         Grid.ColumnSpan="2">
                                        <Label Text="{Binding Employee.Name}" TextColor="Black" FontSize="14"/>
                                        <Label Text="{Binding Employee.Phone}" TextColor="Black" FontSize="14"/>
                                        <Label Text="{Binding Employee.Email}" TextColor="Black" FontSize="14"/>
                                    </VerticalStackLayout>

                                    <!-- Area -->
                                    <Label Text="{Binding Area.Name}"
                                           FontSize="16"
                                           FontAttributes="Bold"
                                           TextColor="White"
                                           Grid.Row="2" Grid.Column="0" />

                                    <!-- Show locations button -->
                                    <Button Text="Vis lokationer"
                                            FontSize="12"
                                            Padding="6,2"
                                            CornerRadius="12"
                                            BackgroundColor="White"
                                            TextColor="Black"
                                            Grid.Row="2" Grid.Column="1"
                                            Clicked="OnShowNoShowLocationsTapped" />
                                </Grid>

                                <!-- Locations list -->
                                <CollectionView IsVisible="{Binding IsVisibleTemplateSchedule}"
                                                ItemsSource="{Binding Area.TemplateSchedules}">
                                    <CollectionView.ItemTemplate>
                                        <DataTemplate>
                                            <Border Stroke="LightGray"
                                                    StrokeShape="RoundRectangle 6"
                                                    BackgroundColor="#f0f0f0"
                                                    Padding="8"
                                                    Margin="4">
                                                <VerticalStackLayout>
                                                    <Label Text="{Binding LocationName}" FontSize="16" />
                                                    <Label Text="{Binding Date, StringFormat='{0:dd-MM-yyyy}'}" FontSize="14" />
                                                    <Label Text="{Binding ShopOpenTimeInterval}" FontSize="14" />
                                                </VerticalStackLayout>
                                                <Border.GestureRecognizers>
                                                    <TapGestureRecognizer Tapped="OnTruckLocationTapped" />
                                                </Border.GestureRecognizers>
                                            </Border>
                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>
                                </CollectionView>
                            </VerticalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

        </VerticalStackLayout>
    </ScrollView>
</ContentView>
