<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MackiesPhoneApp.Pages.User.OrderBasketPage"
             Title="">
    <ScrollView>

        <VerticalStackLayout Padding="10" BackgroundColor="{AppThemeBinding Light={StaticResource AppToolbarBackgroundColorLight}, Dark={StaticResource AppToolbarBackgroundColorDark}}">
           
            <CollectionView x:Name="OrderItemsList" ItemsSource="{Binding OrderItemsList}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame CornerRadius="5"  Padding="10" Margin="2" BackgroundColor="{AppThemeBinding Light={StaticResource ViewItemBorderColorLight}, Dark={StaticResource ViewItemBorderColorDark}}" >
                            <Frame Padding="0" Margin="0" CornerRadius="8" BackgroundColor="{AppThemeBinding Light={StaticResource ViewItemBackgroundColorLight}, Dark={StaticResource ViewItemBackgroundColorDark}}">
                                <VerticalStackLayout>
                                    <HorizontalStackLayout Margin="10" Spacing="20" >
                                    <Border Stroke="White"
                                            StrokeThickness="2"
                                            StrokeShape="RoundRectangle 40"
                                            BackgroundColor="#2c509c"
                                            HeightRequest="40"
                                            WidthRequest="40"
                                            HorizontalOptions="Center"
                                            VerticalOptions="Center">
                                            <Image BackgroundColor="transparent" Source="minussign.png"
                                               WidthRequest="20"                              
                                               InputTransparent="False">   
                                        <Image.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnImageMinusTapped" />
                                        </Image.GestureRecognizers>
                                        </Image>
                                       </Border>

                                        <Border Stroke="White"
                                                 StrokeThickness="1"
                                                 StrokeShape="RoundRectangle 10"
                                                 BackgroundColor="#ffffff"
                                                 HeightRequest="40"
                                                 WidthRequest="40"
                                                 HorizontalOptions="Center"
                                                 VerticalOptions="Center">  
                                            <Label Text="{Binding quantity}" 
                                                   TextColor="Black" 
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center"
                                                   HorizontalTextAlignment="Center"
                                                   VerticalTextAlignment="Center"   
                                                   FontSize="16"/>
                                        </Border>

                                        <Border Stroke="White"
                                               StrokeThickness="2"
                                               StrokeShape="RoundRectangle 40"
                                               BackgroundColor="#2c509c"
                                               HeightRequest="40"
                                               WidthRequest="40"
                                               HorizontalOptions="Center"
                                               VerticalOptions="Center">    
                                            <Image BackgroundColor="transparent" Source="plussign.png"
                                                   WidthRequest="30"
                                                   HeightRequest="30">  
                                                <Image.GestureRecognizers>
                                                    <TapGestureRecognizer Tapped="OnImagePlusTapped" />
                                                </Image.GestureRecognizers>
                                            </Image>
                                        </Border>   
                                    </HorizontalStackLayout>

                                    <Grid ColumnSpacing="10"
                                          HorizontalOptions="Start">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                        </Grid.RowDefinitions>

                                        <Image Grid.Column="0"                                           
                                             Grid.Row="0"
                                             Source="{Binding imageurl}"
                                               Margin="10,0,0,10"
                                             WidthRequest="100"
                                             HeightRequest="100"
                                             Aspect="AspectFill"
                                             VerticalOptions="Center" />    
                                        
                                        <VerticalStackLayout Grid.Column="1" Margin="0,0,0,0" Spacing="5" >
                                      
                                        <Label Text="{Binding productname}" TextColor="Black" FontSize="16" />
                                            <Label Text="{Binding unitprice, StringFormat='{0:C} /stk'}" TextColor="Black" FontSize="16" />
                                        <Label Text="{Binding LineTotal, StringFormat='Ialt: {0:C}'}" TextColor="Black" FontSize="16"/>
                                    </VerticalStackLayout>

                                    </Grid>




                                </VerticalStackLayout>
                            </Frame>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Frame CornerRadius="8" BackgroundColor="LightGray"  Margin="10">
                <VerticalStackLayout>

                    <Editor x:Name="Comment"
                    Text="{Binding Comment}"
                         BackgroundColor="White" 
                        TextColor="Black"
                    Placeholder="Type your text here..."
                    AutoSize="TextChanges"
                    HeightRequest="200"
                    Keyboard="Text" />

                    <Entry x:Name="UsernameEntry"
              Placeholder="Navn"
               PlaceholderColor="Gray"               
               Text="{Binding CustomerName}"
               TextColor="Black" />

                    <Entry x:Name="EmailEntry"
             Placeholder="Email"
                PlaceholderColor="Gray"               
                Text="{Binding CustomerEmail}"
                TextColor="Black" />

                    <Label x:Name="ErrorLabelEmailEntry"
        TextColor="Red"
 >

                    </Label>
                    

                    <Entry x:Name="PhoneNumberEntry"
                Placeholder="Telefonnummer"
                PlaceholderColor="Gray"               
                Text="{Binding CustomerPhoneNumber}"
                TextColor="Black" />

                    <HorizontalStackLayout  Spacing="10" HorizontalOptions="Center" >
                        <Button Text="Nulstil ordre"
                        Clicked="OnClearClicked"                        
                        BackgroundColor="{AppThemeBinding Light={StaticResource OrderBasketButtonBackgroundColorLight}, Dark={StaticResource ViewItemBackgroundColorDark}}"
                        />

                        <Button Text="Send order" 
                            Clicked="OnSubmitOrderClicked" 
                              BackgroundColor="{AppThemeBinding Light={StaticResource OrderBasketButtonBackgroundColorLight}, Dark={StaticResource ViewItemBackgroundColorDark}}" />


               
                    </HorizontalStackLayout>

                    <Label x:Name="ErrorLabelNoOrderlines"
                           TextColor="Red"
                    >

                    </Label>

                    <Frame Margin="0,20,0,0">
                        <VerticalStackLayout >

                            <Label Margin="0,0,0,20" Text="Afhentning:" FontSize="18" FontAttributes="Bold"/>

                            <Label Text="{Binding TemplateSchedule.Date,  StringFormat='{0:dd-MM-yyyy}'}" />
                            <Label Text="{Binding TemplateSchedule.ShopOpenTimeInterval}" />
                            <Label Text="{Binding TemplateSchedule.LocationName}" />
                            <Label Text="{Binding TemplateSchedule.Location.Address}" />
                       
                    </VerticalStackLayout>
                    </Frame>



                </VerticalStackLayout>
               
            </Frame>

            
        </VerticalStackLayout>
       
    </ScrollView>
</ContentPage>